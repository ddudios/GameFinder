# iOS 프로젝트 개발 지침

## 프로젝트 기본 설정
- 최소 iOS 16 타겟, 세로 모드 전용, 라이트 모드와 다크모드 지원
- UIKit 기반, 스토리보드 금지 (100% 코드베이스)
- 의존성: SnapKit(레이아웃), Kingfisher(이미지), RxSwift(반응형), Alamofire(네트워크), RealmSwift(로컬 데이터베이스)
- Localization 적용
- VoiceOver 접근성 기능은 사용하지 않음

## 아키텍처 원칙
- MVVM 패턴 적용, 단일 책임 원칙(SRP) 엄격히 준수
- ViewModel은 RxSwift 기반 Input/Output 패턴 사용
- Input/Output은 struct로 정의
- DI(의존성 주입), DIP(의존성 역전) 패턴은 적용하지 않음
- NetworkManager 등 네트워크 레이어는 별도 클래스로 분리

## Realm 데이터베이스 관리
- 앱이 이미 출시되었으므로 스키마 변경 시 반드시 마이그레이션 코드 필수
- 마이그레이션은 AppDelegate 또는 SceneDelegate에서 앱 시작 시 실행
- schemaVersion을 명시적으로 관리하고 변경 시마다 증가
- 마이그레이션 블록에서 oldSchemaVersion을 확인하여 단계별 처리

### Realm 마이그레이션 작성 규칙
```swift
// 예시 구조
let config = Realm.Configuration(
    schemaVersion: 2, // 스키마 변경 시마다 1씩 증가
    migrationBlock: { migration, oldSchemaVersion in
        if oldSchemaVersion < 1 {
            // 버전 0 -> 1 마이그레이션
        }
        if oldSchemaVersion < 2 {
            // 버전 1 -> 2 마이그레이션
        }
    }
)
Realm.Configuration.defaultConfiguration = config
```

### 마이그레이션 시나리오별 처리
1. 프로퍼티 추가: 기본값 자동 할당됨
2. 프로퍼티 삭제: 자동으로 처리되지만 명시적으로 문서화
3. 프로퍼티 타입 변경: migration.enumerateObjects로 데이터 변환 필수
4. 프로퍼티명 변경: migration.renameProperty 사용
5. 클래스명 변경: @Persisted(originName:) 또는 데이터 복사 후 재생성

### 주의사항
- 마이그레이션 코드는 절대 삭제하지 않음 (구버전 사용자 대응)
- 각 버전별 마이그레이션 로직 명확히 주석 작성
- 스키마 변경 시 schemaVersion 업데이트 필수
- 마이그레이션 실패 시 사용자에게 명확한 에러 메시지 제공

## 코드 작성 규칙
- Swift API Design Guidelines 엄격히 준수 (https://www.swift.org/documentation/api-design-guidelines/)
- 명확성(Clarity) 최우선, 불필요한 축약 금지
- 함수/메서드/변수/타입명은 역할을 명확히 드러내도록 작성
- 모든 public 선언에 문서 주석(///) 필수 작성
- Argument Label 가이드라인 준수, 기본값 파라미터는 끝에 배치
- final 키워드 적극 활용
- access control(private, fileprivate 등) 명시적으로 사용

## 주석 작성 규칙
- 문서 주석(///)은 명확하고 간결하게 작성
- 이모지/이모티콘 사용 금지
- 주석은 코드의 "왜"를 설명하는 데 집중
- 불필요한 장식이나 구분선 사용 자제
- Realm 마이그레이션 코드에는 버전별 변경 사항 명시적으로 주석 작성

## 다국어 지원 (Localization)
- Localizable.xcstrings 파일로 관리
- String extension의 .localized 프로퍼티 사용
- L10n enum을 통한 타입 안전한 접근 (예: L10n.TabBar.first, L10n.Finder.navTitle)
- 하드코딩된 사용자 대면 문자열 절대 금지
- 새로운 텍스트 추가 시:
  1. Localizable.xcstrings에 키 추가
  2. L10n enum에 해당 static let 프로퍼티 추가
  3. 코드에서 L10n을 통해 접근
- NSLocalizedString 직접 사용 금지, 반드시 L10n enum 사용

## 메모리 및 성능
- 순환참조 방지 필수 ([weak self], [unowned self] 적절히 사용)
- 재사용 가능한 컴포넌트(커스텀 뷰, 셀, 유틸리티) 우선 설계
- 테스트 가능한 구조 지향
- Realm 객체는 autorelease pool 활용하여 메모리 효율 관리

## 파일 및 구조
- 중복된 파일명/클래스명 절대 금지
- 재사용 컴포넌트는 별도 파일/모듈로 분리
- 각 클래스/구조체는 하나의 책임만 가지도록 설계
- L10n enum은 기능/화면별로 nested enum 구조로 조직화
- Realm 마이그레이션 코드는 별도 파일(예: RealmMigration.swift)로 분리 가능

## 금지 사항
- 스토리보드 사용 금지
- VoiceOver 접근성 코드 작성 금지
- API Design Guidelines 위반
- 불명확한 네이밍
- 순환참조 발생 코드
- 중복 파일명
- 하드코딩된 사용자 대면 텍스트
- NSLocalizedString 직접 호출 (L10n enum을 통해서만 접근)
- 주석 내 이모지/이모티콘 사용 금지
- Realm 스키마 변경 시 마이그레이션 코드 누락 금지
- schemaVersion 업데이트 누락 금지

위 규칙을 위반하는 코드는 작성하지 말고, 기존 코드 수정 시에도 이 규칙을 적용하여 리팩토링할 것.
